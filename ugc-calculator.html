<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UGC Pricing Calculator | Linear</title>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Config -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                    colors: {
                        brand: {
                            dark: '#050505',
                            card: '#0f0f0f',
                            accent: '#5D5CDE',
                            accentHover: '#4b4ac0',
                            text: '#E5E7EB',
                            muted: '#9CA3AF',
                            success: '#10B981',
                            warning: '#F59E0B',
                            danger: '#EF4444'
                        }
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-brand-dark text-brand-text font-sans antialiased min-h-screen flex items-center justify-center p-6">

    <div class="max-w-5xl w-full bg-brand-card border border-white/10 rounded-2xl p-8 shadow-2xl">
        
        <div class="flex justify-between items-center mb-8 border-b border-white/10 pb-6">
            <div>
                <h1 class="text-3xl font-bold text-white uppercase">UGC Pricing Calculator</h1>
                <p class="text-gray-400 text-sm mt-1">Calculate custom UGC package pricing with margin protection.</p>
            </div>
            <div class="px-4 py-2 bg-brand-accent/10 border border-brand-accent/20 rounded-lg text-brand-accent text-xs font-bold uppercase tracking-wider">
                Internal Use Only
            </div>
        </div>

        <div class="grid lg:grid-cols-2 gap-12">
            
            <!-- CONTROLS -->
            <div class="space-y-8">
                <!-- Premium Angles -->
                <div class="bg-brand-dark p-6 rounded-xl border border-white/5">
                    <div class="flex justify-between items-center mb-4">
                        <label class="font-bold text-white">Premium Angles</label>
                        <span class="text-xs text-brand-muted">($187.50/angle)</span>
                    </div>
                    <div class="flex items-center gap-4">
                        <button onclick="updateCount('premium', -4)" class="w-12 h-12 rounded-lg bg-white/5 hover:bg-white/10 text-white flex items-center justify-center transition border border-white/10"><i class="fa-solid fa-minus"></i></button>
                        <input type="number" id="premium-count" value="0" readonly class="flex-1 h-12 bg-transparent text-center text-white font-mono text-xl focus:outline-none border-b border-white/10">
                        <button onclick="updateCount('premium', 4)" class="w-12 h-12 rounded-lg bg-white/10 hover:bg-white/20 text-white flex items-center justify-center transition border border-white/10"><i class="fa-solid fa-plus"></i></button>
                    </div>
                    <div class="mt-2 text-right text-xs text-gray-500">Increments of 4</div>
                </div>

                <!-- Regular Angles -->
                <div class="bg-brand-dark p-6 rounded-xl border border-white/5">
                    <div class="flex justify-between items-center mb-4">
                        <label class="font-bold text-white">Regular Angles</label>
                        <span class="text-xs text-brand-muted">($70.00/angle)</span>
                    </div>
                    <div class="flex items-center gap-4">
                        <button onclick="updateCount('regular', -5)" class="w-12 h-12 rounded-lg bg-white/5 hover:bg-white/10 text-white flex items-center justify-center transition border border-white/10"><i class="fa-solid fa-minus"></i></button>
                        <input type="number" id="regular-count" value="0" readonly class="flex-1 h-12 bg-transparent text-center text-white font-mono text-xl focus:outline-none border-b border-white/10">
                        <button onclick="updateCount('regular', 5)" class="w-12 h-12 rounded-lg bg-white/10 hover:bg-white/20 text-white flex items-center justify-center transition border border-white/10"><i class="fa-solid fa-plus"></i></button>
                    </div>
                    <div class="mt-2 text-right text-xs text-gray-500">Increments of 5</div>
                </div>

                <!-- Statics -->
                <div class="bg-brand-dark p-6 rounded-xl border border-white/5">
                    <div class="flex justify-between items-center mb-4">
                        <label class="font-bold text-white">Statics</label>
                        <span class="text-xs text-brand-muted">($8.00/static)</span>
                    </div>
                    <div class="flex items-center gap-4">
                        <button onclick="updateCount('static', -5)" class="w-12 h-12 rounded-lg bg-white/5 hover:bg-white/10 text-white flex items-center justify-center transition border border-white/10"><i class="fa-solid fa-minus"></i></button>
                        <input type="number" id="static-count" value="0" readonly class="flex-1 h-12 bg-transparent text-center text-white font-mono text-xl focus:outline-none border-b border-white/10">
                        <button onclick="updateCount('static', 5)" class="w-12 h-12 rounded-lg bg-white/10 hover:bg-white/20 text-white flex items-center justify-center transition border border-white/10"><i class="fa-solid fa-plus"></i></button>
                    </div>
                    <div class="mt-2 text-right text-xs text-gray-500">Increments of 5</div>
                </div>
            </div>

            <!-- RESULTS -->
            <div class="space-y-6">
                
                <!-- Package Summary -->
                <div class="bg-brand-dark p-6 rounded-xl border border-white/5">
                    <h3 class="text-xs font-bold text-gray-500 uppercase tracking-widest mb-4">Package Summary</h3>
                    <div class="space-y-2 text-sm">
                        <div class="flex justify-between border-b border-white/5 pb-2 mb-2">
                            <span class="text-gray-400">Total Angles:</span>
                            <span class="text-white font-mono font-bold text-lg" id="summary-angles">0</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-400">Total Statics:</span>
                            <span class="text-white font-mono font-bold text-lg" id="summary-statics">0</span>
                        </div>
                    </div>
                </div>

                <!-- COGS Breakdown -->
                <div class="bg-brand-dark p-6 rounded-xl border border-white/5">
                    <h3 class="text-xs font-bold text-gray-500 uppercase tracking-widest mb-4">Cost Analysis (COGS)</h3>
                    <div class="space-y-2 text-sm">
                        <div class="flex justify-between">
                            <span class="text-gray-400">Premium Production Cost:</span>
                            <span class="text-white font-mono" id="cogs-premium">$0.00</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-400">Regular Production Cost:</span>
                            <span class="text-white font-mono" id="cogs-regular">$0.00</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-400">Static Production Cost:</span>
                            <span class="text-white font-mono" id="cogs-static">$0.00</span>
                        </div>
                        <div class="border-t border-white/10 my-2 pt-2 flex justify-between font-bold">
                            <span class="text-brand-muted">Total COGS:</span>
                            <span class="text-brand-warning font-mono" id="cogs-total">$0.00</span>
                        </div>
                    </div>
                </div>

                <!-- Margin Logic -->
                <div class="bg-brand-dark p-6 rounded-xl border border-white/5">
                    <h3 class="text-xs font-bold text-gray-500 uppercase tracking-widest mb-4">Pricing Strategy</h3>
                    
                    <div class="mb-6">
                        <div class="flex justify-between items-end mb-1">
                            <span class="text-gray-400 text-sm">Min Price for 80% Margin</span>
                            <span class="text-white font-bold font-mono text-lg" id="price-floor">$0.00</span>
                        </div>
                        <div class="w-full bg-gray-800 rounded-full h-1.5">
                            <div class="bg-brand-success h-1.5 rounded-full" style="width: 80%"></div>
                        </div>
                    </div>

                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-2">
                            <span class="text-gray-400 text-sm">Volume Discount Tier</span>
                            <span class="px-2 py-1 rounded bg-white/10 text-xs font-bold text-white" id="discount-badge">0%</span>
                        </div>
                    </div>

                    <div class="bg-brand-accent/10 border border-brand-accent rounded-lg p-4 text-center">
                        <div class="text-xs text-brand-accent font-bold uppercase tracking-wider mb-2">Recommended Pricing</div>
                        
                        <div class="space-y-1 mb-4">
                            <div class="flex justify-between text-xs text-gray-400">
                                <span>Standard Price:</span>
                                <span class="text-white font-mono line-through" id="standard-price">$0.00</span>
                            </div>
                            <div class="flex justify-between text-xs text-brand-success">
                                <span>Volume Discount (<span id="discount-percent">0%</span>):</span>
                                <span class="font-mono" id="discount-amount">-$0.00</span>
                            </div>
                        </div>

                        <div class="text-4xl font-extrabold text-white tracking-tight pt-2 border-t border-brand-accent/20" id="final-price">$0</div>
                        
                        <div class="text-xs text-gray-400 mt-3 flex flex-col gap-1 items-center">
                            <div class="flex justify-between w-full max-w-[200px]"><span>Net Revenue:</span> <span id="net-revenue" class="text-white font-mono font-bold">$0</span></div>
                            <div class="flex justify-between w-full max-w-[200px]"><span>Gross Profit:</span> <span id="gross-profit" class="text-brand-success font-mono font-bold">$0</span></div>
                            <div class="flex justify-between w-full max-w-[200px]"><span>Margin:</span> <span id="final-margin" class="text-gray-300 font-bold">0%</span></div>
                        </div>
                    </div>
                </div>

                <!-- Discount Legend -->
                <div class="grid grid-cols-4 gap-2 text-center text-[10px] text-gray-500 opacity-60">
                    <div class="bg-white/5 p-2 rounded border border-white/5">
                        >$7k = 10%
                    </div>
                    <div class="bg-white/5 p-2 rounded border border-white/5">
                        >$10k = 15%
                    </div>
                    <div class="bg-white/5 p-2 rounded border border-white/5">
                        >$15k = 20%
                    </div>
                    <div class="bg-white/5 p-2 rounded border border-white/5">
                        >$20k = 25%
                    </div>
                </div>

            </div>
        </div>

        <!-- SECTION 2: REVERSE CALCULATOR -->
        <div class="mt-12 w-full bg-brand-card border border-white/10 rounded-2xl p-8 shadow-2xl">
            <div class="mb-8 border-b border-white/10 pb-6">
                <h2 class="text-2xl font-bold text-white uppercase"><i class="fa-solid fa-calculator mr-2 text-brand-muted"></i> Reverse Margin Calculator</h2>
                <p class="text-gray-400 text-sm mt-1">Check profitability on a client's specific proposal.</p>
            </div>

            <div class="grid lg:grid-cols-3 gap-8">
                <!-- Proposal Inputs -->
                <div class="lg:col-span-2 space-y-6">
                    <div class="bg-brand-dark p-6 rounded-xl border border-white/5">
                        <label class="block text-sm font-bold text-white mb-2">Proposed Package Price</label>
                        <div class="relative">
                            <span class="absolute left-4 top-1/2 -translate-y-1/2 text-gray-400">$</span>
                            <input type="number" id="proposal-price" class="w-full bg-white/5 border border-white/10 rounded-lg px-8 py-3 text-white focus:outline-none focus:border-brand-accent focus:ring-1 focus:ring-brand-accent transition" placeholder="e.g. 5000" oninput="calculateReverse()">
                        </div>
                    </div>

                    <div class="grid md:grid-cols-3 gap-6">
                        <!-- Reverse Premium -->
                        <div class="bg-brand-dark p-4 rounded-xl border border-white/5 text-center">
                            <label class="block text-xs font-bold text-gray-400 mb-3">Premium Angles</label>
                            <div class="flex items-center justify-center gap-2">
                                <button onclick="updateReverseCount('premium', -4)" class="w-8 h-8 rounded bg-white/5 hover:bg-white/10 text-white flex items-center justify-center transition border border-white/10"><i class="fa-solid fa-minus text-xs"></i></button>
                                <input type="number" id="rev-premium" class="w-12 bg-transparent text-center text-white font-mono focus:outline-none" value="0" readonly>
                                <button onclick="updateReverseCount('premium', 4)" class="w-8 h-8 rounded bg-white/10 hover:bg-white/20 text-white flex items-center justify-center transition border border-white/10"><i class="fa-solid fa-plus text-xs"></i></button>
                            </div>
                        </div>

                        <!-- Reverse Regular -->
                        <div class="bg-brand-dark p-4 rounded-xl border border-white/5 text-center">
                            <label class="block text-xs font-bold text-gray-400 mb-3">Regular Angles</label>
                            <div class="flex items-center justify-center gap-2">
                                <button onclick="updateReverseCount('regular', -5)" class="w-8 h-8 rounded bg-white/5 hover:bg-white/10 text-white flex items-center justify-center transition border border-white/10"><i class="fa-solid fa-minus text-xs"></i></button>
                                <input type="number" id="rev-regular" class="w-12 bg-transparent text-center text-white font-mono focus:outline-none" value="0" readonly>
                                <button onclick="updateReverseCount('regular', 5)" class="w-8 h-8 rounded bg-white/10 hover:bg-white/20 text-white flex items-center justify-center transition border border-white/10"><i class="fa-solid fa-plus text-xs"></i></button>
                            </div>
                        </div>

                        <!-- Reverse Static -->
                        <div class="bg-brand-dark p-4 rounded-xl border border-white/5 text-center">
                            <label class="block text-xs font-bold text-gray-400 mb-3">Statics</label>
                            <div class="flex items-center justify-center gap-2">
                                <button onclick="updateReverseCount('static', -5)" class="w-8 h-8 rounded bg-white/5 hover:bg-white/10 text-white flex items-center justify-center transition border border-white/10"><i class="fa-solid fa-minus text-xs"></i></button>
                                <input type="number" id="rev-static" class="w-12 bg-transparent text-center text-white font-mono focus:outline-none" value="0" readonly>
                                <button onclick="updateReverseCount('static', 5)" class="w-8 h-8 rounded bg-white/10 hover:bg-white/20 text-white flex items-center justify-center transition border border-white/10"><i class="fa-solid fa-plus text-xs"></i></button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Reverse Results -->
                <div class="bg-brand-dark p-6 rounded-xl border border-white/5 flex flex-col justify-center">
                    
                    <!-- NEW: Package Summary in Reverse -->
                    <div class="mb-6 border-b border-white/5 pb-4">
                        <div class="flex justify-between text-sm text-gray-400 mb-1">
                            <span>Total Angles:</span>
                            <span class="text-white font-mono font-bold" id="rev-total-angles">0</span>
                        </div>
                        <div class="flex justify-between text-sm text-gray-400">
                            <span>Total Statics:</span>
                            <span class="text-white font-mono font-bold" id="rev-total-statics">0</span>
                        </div>
                    </div>

                    <div class="mb-6">
                        <div class="text-xs text-gray-500 uppercase tracking-widest mb-1">Estimated Cost (COGS)</div>
                        <div class="text-2xl font-mono text-white" id="rev-cogs">$0.00</div>
                    </div>
                    
                    <div class="mb-6">
                        <div class="text-xs text-gray-500 uppercase tracking-widest mb-1">Gross Profit</div>
                        <div class="text-2xl font-mono text-brand-success" id="rev-profit">$0.00</div>
                    </div>

                    <div class="pt-6 border-t border-white/10">
                        <div class="flex justify-between items-center mb-2">
                            <span class="text-sm font-bold text-white">Final Margin</span>
                            <span class="text-xl font-bold" id="rev-margin">0%</span>
                        </div>
                        <!-- Progress Bar -->
                        <div class="w-full bg-gray-800 rounded-full h-2 overflow-hidden">
                            <div id="rev-margin-bar" class="bg-brand-success h-2 rounded-full transition-all duration-500" style="width: 0%"></div>
                        </div>
                        <p id="rev-status" class="text-xs text-center mt-2 font-medium text-gray-500">Enter details...</p>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <!-- Logic -->
    <script>
        // UNIT COSTS
        const COST_PREMIUM_ANGLE = 187.50;
        const COST_REGULAR_ANGLE = 70.00;
        const COST_STATIC = 8.00;

        // TARGET MARGIN
        const TARGET_MARGIN = 0.80; // 80%

        let counts = {
            premium: 0,
            regular: 0,
            static: 0
        };

        // --- FORWARD CALCULATOR ---

        function updateCount(type, change) {
            const newCount = counts[type] + change;
            if (newCount < 0) return;
            counts[type] = newCount;
            
            // Input shows Total Count directly
            document.getElementById(`${type}-count`).value = counts[type];
            calculate();
        }

        function calculate() {
            // 1. Calculate Totals
            const totalAngles = counts.premium + counts.regular;

            // 2. Calculate COGS (Cost of Goods Sold)
            const cogsPremium = counts.premium * COST_PREMIUM_ANGLE;
            const cogsRegular = counts.regular * COST_REGULAR_ANGLE;
            const cogsStatic = counts.static * COST_STATIC;
            
            const totalCOGS = cogsPremium + cogsRegular + cogsStatic;

            // 3. Calculate Minimum Sell Price to hit 80% Margin (Net Revenue needed)
            // Net Revenue - COGS = Margin * Net Revenue  =>  Net Revenue * (1 - Margin) = COGS
            const requiredNetRevenue = totalCOGS > 0 ? (totalCOGS / (1 - TARGET_MARGIN)) : 0;

            // 4. Calculate Standard List Price (Pre-Discount)
            // We need a Standard Price X such that: X * (1 - discount_rate) >= requiredNetRevenue
            // We solve this by finding the lowest X that satisfies the discount tier thresholds.
            
            // Base case: No discount
            let standardPrice = requiredNetRevenue;
            let discountRate = 0;

            // Iteratively bump up the price to account for discounts at various levels
            
            // Check if we qualify for 25% discount (>20k list)
            // Price needed if 25% off:
            let priceFor25 = requiredNetRevenue / 0.75;
            if (priceFor25 > 20000) {
                standardPrice = priceFor25;
                discountRate = 0.25;
            } else {
                // Check 20% discount (>15k list)
                let priceFor20 = requiredNetRevenue / 0.80;
                if (priceFor20 > 15000) {
                    standardPrice = priceFor20;
                    discountRate = 0.20;
                } else {
                    // Check 15% discount (>10k list)
                    let priceFor15 = requiredNetRevenue / 0.85;
                    if (priceFor15 > 10000) {
                        standardPrice = priceFor15;
                        discountRate = 0.15;
                    } else {
                        // Check 10% discount (>7k list)
                        let priceFor10 = requiredNetRevenue / 0.90;
                        if (priceFor10 > 7000) {
                            standardPrice = priceFor10;
                            discountRate = 0.10;
                        } else {
                            // No discount
                            standardPrice = requiredNetRevenue;
                            discountRate = 0;
                        }
                    }
                }
            }

            // 5. Final Calculations
            const discountVal = standardPrice * discountRate;
            const finalPrice = standardPrice - discountVal; // This should be >= requiredNetRevenue
            const grossProfit = finalPrice - totalCOGS;
            const actualMargin = finalPrice > 0 ? (grossProfit / finalPrice) * 100 : 0;

            // 6. Update UI
            
            // Summary Box
            document.getElementById('summary-angles').innerText = totalAngles;
            document.getElementById('summary-statics').innerText = counts.static;

            // COGS
            document.getElementById('cogs-premium').innerText = formatMoney(cogsPremium);
            document.getElementById('cogs-regular').innerText = formatMoney(cogsRegular);
            document.getElementById('cogs-static').innerText = formatMoney(cogsStatic);
            document.getElementById('cogs-total').innerText = formatMoney(totalCOGS);

            // Pricing
            document.getElementById('price-floor').innerText = formatMoney(requiredNetRevenue);
            
            document.getElementById('discount-badge').innerText = (discountRate * 100) + '%';
            
            document.getElementById('standard-price').innerText = formatMoney(standardPrice);
            document.getElementById('discount-percent').innerText = (discountRate * 100) + '%';
            document.getElementById('discount-amount').innerText = '-' + formatMoney(discountVal);
            
            document.getElementById('final-price').innerText = formatMoney(finalPrice);

            // Stats
            document.getElementById('net-revenue').innerText = formatMoney(finalPrice);
            document.getElementById('gross-profit').innerText = formatMoney(grossProfit);
            
            const marginEl = document.getElementById('final-margin');
            marginEl.innerText = actualMargin.toFixed(1) + '%';
            
            if (actualMargin < 79.9) { 
                marginEl.classList.remove('text-brand-success');
                marginEl.classList.add('text-brand-danger');
            } else {
                marginEl.classList.remove('text-brand-danger');
                marginEl.classList.add('text-brand-success');
            }
        }

        // --- REVERSE CALCULATOR ---

        // Reverse state
        let revCounts = {
            premium: 0,
            regular: 0,
            static: 0
        };

        function updateReverseCount(type, change) {
            const newCount = revCounts[type] + change;
            if (newCount < 0) return;
            
            revCounts[type] = newCount;
            document.getElementById(`rev-${type}`).value = revCounts[type];
            calculateReverse();
        }

        function calculateReverse() {
            const price = parseFloat(document.getElementById('proposal-price').value) || 0;
            const pAngles = revCounts.premium;
            const rAngles = revCounts.regular;
            const statics = revCounts.static;

            const cogs = (pAngles * COST_PREMIUM_ANGLE) + (rAngles * COST_REGULAR_ANGLE) + (statics * COST_STATIC);
            const profit = price - cogs;
            const margin = price > 0 ? (profit / price) * 100 : 0;
            
            const totalAngles = pAngles + rAngles;

            // UI Update
            document.getElementById('rev-cogs').innerText = formatMoney(cogs);
            document.getElementById('rev-total-angles').innerText = totalAngles;
            document.getElementById('rev-total-statics').innerText = statics;
            
            const profitEl = document.getElementById('rev-profit');
            profitEl.innerText = formatMoney(profit);
            
            // Color Logic
            const marginEl = document.getElementById('rev-margin');
            const barEl = document.getElementById('rev-margin-bar');
            const statusEl = document.getElementById('rev-status');

            marginEl.innerText = margin.toFixed(1) + '%';
            barEl.style.width = Math.min(Math.max(margin, 0), 100) + '%'; // Clamp 0-100

            if (margin >= 80) {
                // Good
                profitEl.className = "text-2xl font-mono text-brand-success";
                marginEl.className = "text-xl font-bold text-brand-success";
                barEl.className = "h-2 rounded-full transition-all duration-500 bg-brand-success";
                statusEl.innerText = "Excellent. Meets 80% margin target.";
                statusEl.className = "text-xs text-center mt-2 font-medium text-brand-success";
            } else if (margin >= 60) {
                // Okay
                profitEl.className = "text-2xl font-mono text-brand-warning";
                marginEl.className = "text-xl font-bold text-brand-warning";
                barEl.className = "h-2 rounded-full transition-all duration-500 bg-brand-warning";
                statusEl.innerText = "Caution. Below 80% target but profitable.";
                statusEl.className = "text-xs text-center mt-2 font-medium text-brand-warning";
            } else {
                // Bad
                profitEl.className = "text-2xl font-mono text-brand-danger";
                marginEl.className = "text-xl font-bold text-brand-danger";
                barEl.className = "h-2 rounded-full transition-all duration-500 bg-brand-danger";
                statusEl.innerText = "Warning. Margin is too low.";
                statusEl.className = "text-xs text-center mt-2 font-medium text-brand-danger";
            }
        }

        function formatMoney(amount) {
            return '$' + amount.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
        }

        calculate();
    </script>

</body>
</html>
